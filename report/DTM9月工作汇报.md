## DTM9月工作汇报

### 数据侧：数据清洗、分析

- 对过去三年乳胶枕销售数据进行统计分析，包括数据分布、可视化、特征工程与相关性分析
- 对销售数据进行周期性特征划分，选择特征主成分以及构建数据集
- 完成部分2018年细化推广数据的调研报告，挖掘特征间因果关系（目的，优化后期的特征选取，增强解释性）

### 算法侧：模型训练、优化与功能协调

从个人工作路径来看，9月份计划主要是两个部分，细分为四个任务。第一部分是生命周期曲线（销量）的拟合以及自定义策略下的周期走势。第二部分是周期预测中除销量外特征几个重要kpi特征的走势（包括ROI 利率 单价......）以及最优化策略。这两个部分的完成过程是相辅相成的，最初的想法是优先销量模型的建模，基于销量的预期反推其余kpi特征的走势。这种思路的本质是考虑两个对偶模型，记销量为y， 特征为x，构建两个模型y = f(x) 与x = g(y)，如果成立的话模型的拟合其实是寻找两个互为反函数的模型，整个建模、求解的过程将变得非常复杂。

在完成销量模型的训练之后我调整的思路，将特征与销量模型设定为两个并行的时间序列模型，首先挖掘特征走势的时序性特征，再基于特征的预测进一步给出销量的预测。同时，这两个时序模型本身具有自回归的特性。

简单建模而言：
$$
X_t = g(X_{t-1}, ..X_{t-p}),\quad Y_t = f(X_t, Y_{t-1}, ..Y_{t-q})
$$
至此，前三个任务的功能的到基本实现。最后需要考虑的是what if 仿真，即对未来销售策略的最优化问题。即
$$
optimize \quad F(X_{t+1}, .. X_{t+d}, Y_{t+1}, ..Y_{t+d})
$$
$F$ 是对应的最优化目标。传统的求解方式包括采用minimize 求解器，grid search 搜寻格点最优以及依靠遗传算法寻找最优解。考虑到我们的预测模型以来深度学习的黑盒函数，梯度难求以及特征维度高，综合考虑可行性与计算时间限制，最终选择遗传算法进行求解。以下简述算法的实现与效果。

- 销量与特征模型
  - 划分周期训练了并行的双层LSTM模型，销量模型的入参依赖特征模型的输出
  - 四个周期数据在训练时进行cross- validation交叉验证，training_loss 降低至0.001
  - 基于自定义策略或者当前最后时间点的特征值预测下一阶段的特征走势，再给出销量曲线的下一阶段走势
  - 数据的走势符合我们生命周期的假设，对于异常的输入特征有纠偏效果
  - 目前回看窗口定为1，存在普遍的时序预测滞后性的问题，在后期会修正参数
- 优化模型
  - 以最大化销量为例，给定入参范围，模型迭代100次，求解时间在1s内
  - 求解得到最优入参后可反向推导参数与销量走势图像
  - 模型需要根据当前销售数据更新，对求解结果有明显影响